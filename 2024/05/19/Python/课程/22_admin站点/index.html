<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="一名菜鸟的日记本">
    <meta property="og:type" content="website">
    <meta name="description" content="一名菜鸟的日记本">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        admin站点 - 神秘的张少爷
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="../../../../../../css/aircloud.css">

    
<link rel="stylesheet" href="../../../../../../css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    
  
  



  



  




  
  
  



  

<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="atom.xml" title="神秘的张少爷" type="application/atom+xml">
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Stay Hungry，Stay Foolish </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>神秘的张少爷</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="../../../../../../index.html">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="../../../../../../tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="../../../../../../archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>COLLECT</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2%E6%9C%AC%E5%9C%B0%E5%8C%96"><span class="toc-text">1.管理界面本地化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-text">2.创建超级管理员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-App%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">3.App应用配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%B3%A8%E5%86%8C%E6%A8%A1%E5%9E%8B%E7%B1%BB"><span class="toc-text">4.注册模型类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%87%AA%E5%AE%9A%E4%B8%8E%E4%BD%BF%E7%94%A8Admin%E7%AE%A1%E7%90%86%E7%B1%BB"><span class="toc-text">5.自定与使用Admin管理类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B0%83%E6%95%B4%E5%88%97%E8%A1%A8%E9%A1%B5%E5%B1%95%E7%A4%BA"><span class="toc-text">6.调整列表页展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B0%83%E6%95%B4%E7%BC%96%E8%BE%91%E9%A1%B5%E5%B1%95%E7%A4%BA"><span class="toc-text">7.调整编辑页展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%B0%83%E6%95%B4%E7%AB%99%E7%82%B9%E4%BF%A1%E6%81%AF"><span class="toc-text">8.调整站点信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87"><span class="toc-text">9.上传图片</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Stay Hungry，Stay Foolish </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        admin站点
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2024-05-19 20:45:57</span></span>
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content no-indent">
        <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/admin/</span><br></pre></td></tr></table></figure>

<h3 id="1-管理界面本地化"><a href="#1-管理界面本地化" class="headerlink" title="1.管理界面本地化"></a>1.管理界面本地化</h3><p>settings.py文件中设置语言和时区</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LANGUAGE_CODE = <span class="string">&#x27;zh-hans&#x27;</span> <span class="comment"># 使用中国语言</span></span><br><span class="line">TIME_ZONE = <span class="string">&#x27;Asia/Shanghai&#x27;</span> <span class="comment"># 使用中国上海时间</span></span><br></pre></td></tr></table></figure>

<h3 id="2-创建超级管理员"><a href="#2-创建超级管理员" class="headerlink" title="2.创建超级管理员"></a>2.创建超级管理员</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改用户密码</span></span><br><span class="line">python manage.py changepassword 用户名</span><br></pre></td></tr></table></figure>

<h3 id="3-App应用配置"><a href="#3-App应用配置" class="headerlink" title="3.App应用配置"></a>3.App应用配置</h3><p>子应用中apps.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BooktestConfig</span>(<span class="title class_ inherited__">AppConfig</span>):</span><br><span class="line">    name = <span class="string">&#x27;booktest&#x27;</span></span><br><span class="line">    verbose_name = <span class="string">&#x27;图书管理&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-注册模型类"><a href="#4-注册模型类" class="headerlink" title="4.注册模型类"></a>4.注册模型类</h3><p>子应用中admin.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin.site.register(BookInfo)</span><br><span class="line">admin.site.register(HeroInfo)</span><br></pre></td></tr></table></figure>

<h3 id="5-自定与使用Admin管理类"><a href="#5-自定与使用Admin管理类" class="headerlink" title="5.自定与使用Admin管理类"></a>5.自定与使用Admin管理类</h3><p>子应用中admin.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">admin.site.site_header = <span class="string">&#x27;传智书城&#x27;</span></span><br><span class="line">admin.site.site_title = <span class="string">&#x27;传智书城MIS&#x27;</span></span><br><span class="line">admin.site.index_title = <span class="string">&#x27;欢迎使用传智书城MIS&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class HeroInfoStackInline(admin.StackedInline):</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HeroInfoTabularInline</span>(admin.TabularInline):</span><br><span class="line">    model = HeroInfo</span><br><span class="line">    extra = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#自定义admin展示效果</span></span><br><span class="line"><span class="comment"># @admin.register(BookInfo) # 方法一 装饰器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookInfoAdmin</span>(admin.ModelAdmin):</span><br><span class="line">    list_per_page = <span class="number">3</span></span><br><span class="line">    list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;btitle&#x27;</span>,<span class="string">&#x27;pub_date&#x27;</span>]</span><br><span class="line">    <span class="comment"># fields = [&#x27;btitle&#x27;, &#x27;bpub_date&#x27;]</span></span><br><span class="line">    fieldsets = (</span><br><span class="line">        (<span class="string">&#x27;基本&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:[<span class="string">&#x27;btitle&#x27;</span>,<span class="string">&#x27;bpub_date&#x27;</span>,<span class="string">&#x27;image&#x27;</span>]&#125;),</span><br><span class="line">        (<span class="string">&#x27;高级&#x27;</span>,&#123;</span><br><span class="line">            <span class="string">&#x27;fields&#x27;</span>:[<span class="string">&#x27;bread&#x27;</span>,<span class="string">&#x27;bcomment&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;classes&#x27;</span>:(<span class="string">&#x27;collapse&#x27;</span>,)</span><br><span class="line">        &#125;)</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># inlines = [HeroInfoStackInline]</span></span><br><span class="line">    inlines = [HeroInfoTabularInline]</span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(<span class="params">HeroInfo</span>)  </span><span class="comment"># 方法一 装饰器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HeroInfoAdmin</span>(admin.ModelAdmin):</span><br><span class="line">    list_per_page = <span class="number">5</span></span><br><span class="line">    list_display = [<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;hname&#x27;</span>,<span class="string">&#x27;hbook&#x27;</span>,<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">    list_filter = [<span class="string">&#x27;hbook&#x27;</span>]</span><br><span class="line">    search_fields = [<span class="string">&#x27;hname&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">admin.site.register(BookInfo,BookInfoAdmin) <span class="comment"># 方法二 注册参数</span></span><br><span class="line"><span class="comment"># admin.site.register(HeroInfo)</span></span><br></pre></td></tr></table></figure>

<p>使用管理类有两种方式</p>
<ul>
<li>注册参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin.site.register(BookInfo,BookInfoAdmin)</span><br></pre></td></tr></table></figure>

<ul>
<li>装饰器</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@admin.register(<span class="params">BookInfo</span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookInfoAdmin</span>(admin.ModelAdmin):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h3 id="6-调整列表页展示"><a href="#6-调整列表页展示" class="headerlink" title="6.调整列表页展示"></a>6.调整列表页展示</h3><ol>
<li><p>list_per_page : 分页展示的page_size</p>
</li>
<li><p>list_display &#x3D; [ ] : 列表页展示的字段 , 点击头部可升序或降序排列</p>
</li>
<li><p>将方法作为列,添加到列表页展示中 ,方法必须有返回值</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在模型类中添加方法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pub_date</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.bpub_date.strftime(<span class="string">&#x27;%Y年%m月%d日&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pub_date.short_description = <span class="string">&#x27;发布日期&#x27;</span>  <span class="comment"># 设置方法字段在admin中显示的标题</span></span><br><span class="line">pub_date.admin_order_field = <span class="string">&#x27;bpub_date&#x27;</span> <span class="comment"># 方法是不能排序的,需要排序时要为方法指定排序依据</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>关联对象 : 使用方法,访问关联对象的属性</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.hbook.bread</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>右侧栏过滤器</li>
</ol>
<p> list_filter &#x3D; [&lt;字段名&gt; ]  : 根据字段快速过滤</p>
<ol start="6">
<li>搜索框</li>
</ol>
<p>search_fields &#x3D; [ ] : 用于搜索的字段</p>
<h3 id="7-调整编辑页展示"><a href="#7-调整编辑页展示" class="headerlink" title="7.调整编辑页展示"></a>7.调整编辑页展示</h3><ol>
<li><p>fields &#x3D; [ ] : 添加展示的字段</p>
</li>
<li><p>fieldsets &#x3D; ( ) : 分组显示  与fields二选一</p>
</li>
</ol>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">fieldsets</span>=(</span><br><span class="line">    (<span class="string">&#x27;组1标题&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:(<span class="string">&#x27;字段1&#x27;</span>,<span class="string">&#x27;字段2&#x27;</span>)&#125;),</span><br><span class="line">    (<span class="string">&#x27;组2标题&#x27;</span>,&#123;<span class="string">&#x27;fields&#x27;</span>:(<span class="string">&#x27;字段3&#x27;</span>,<span class="string">&#x27;字段4&#x27;</span>)&#125;),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>关联对象</li>
</ol>
<p>可以在编辑页面编辑关联对象, 嵌入关联对象的方式有 表格 、块 两种：</p>
<ul>
<li>类型InlineModelAdmin：表示在模型的编辑页面嵌入关联模型的编辑。</li>
<li>子类TabularInline：以表格的形式嵌入。</li>
<li>子类StackedInline：以块的形式嵌入。</li>
</ul>
<p>创建编辑关联对象类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">HeroInfoStackInline</span>(admin.StackedInline):</span><br><span class="line">    model = HeroInfo  <span class="comment"># 要编辑的对象</span></span><br><span class="line">    extra = <span class="number">1</span>  <span class="comment"># 附加编辑的数量 默认为3 预留的用于编辑的空白对象</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookInfoAdmin</span>(admin.ModelAdmin):</span><br><span class="line">    ...</span><br><span class="line">    inlines = [HeroInfoStackInline]</span><br></pre></td></tr></table></figure>

<h3 id="8-调整站点信息"><a href="#8-调整站点信息" class="headerlink" title="8.调整站点信息"></a>8.调整站点信息</h3><ul>
<li><strong>admin.site.site_header</strong> 设置网站页头</li>
<li><strong>admin.site.site_title</strong> 设置页面标题</li>
<li><strong>admin.site.index_title</strong> 设置首页标语</li>
</ul>
<h3 id="9-上传图片"><a href="#9-上传图片" class="headerlink" title="9.上传图片"></a>9.上传图片</h3><p>安装图片操作包： pip install Pillow</p>
<p>settings.py配置:   项目中用于存储照片的文件夹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MEDIA_ROOT=os.path.join(BASE_DIR,<span class="string">&quot;static_files/media&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>模型类添加ImageField字段, upload_to指明该字段图片保存在MEDIA_ROOT目录中的哪个子目录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">image = models.ImageField(upload_to=<span class="string">&#x27;booktest&#x27;</span>, verbose_name=<span class="string">&#x27;图片&#x27;</span>, null=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>数据迁移</p>

        
            <div class="donate-container">
    <div class="donate-button">
        <button id="donate-button">donate</button>
    </div>
    <div class="donate-img-container hide" id="donate-img-container">
        <img id="donate-img" src="" data-src="/img/donate.jpg">
        <p> 感谢您给予的支持 </p>
    </div>
</div>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/忘機">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank" href="http://weibo.com/3919408003">
                            <span class="fa-stack fa-lg">
                                  <i class="iconfont icon-weibo"></i>
                            </span>
            </a>
        </li>
        

        

        
        <li>
            <a target="_blank"  href="https://github.com/MyGodOnLoad">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="../../../../../../js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






</html>
