<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="一名菜鸟的日记本">
    <meta property="og:type" content="website">
    <meta name="description" content="一名菜鸟的日记本">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        非关系型数据库redis - 神秘的张少爷
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="../../../../../../css/aircloud.css">

    
<link rel="stylesheet" href="../../../../../../css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    
  
  



  



  




  
  
  



  

<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="atom.xml" title="神秘的张少爷" type="application/atom+xml">
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Stay Hungry，Stay Foolish </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>神秘的张少爷</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="../../../../../../index.html">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="../../../../../../tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="../../../../../../archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>COLLECT</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nosql"><span class="toc-text">Nosql</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NoSQL-%E4%B8%8E-SQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text">NoSQL 与 SQL数据库的比较</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis"><span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">数据结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis%E6%93%8D%E4%BD%9C"><span class="toc-text">Redis操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E7%AE%A1%E9%81%93%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">redis管道的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8Epython%E4%BA%A4%E4%BA%92"><span class="toc-text">与python交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E"><span class="toc-text">搭建主从</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E9%9B%86%E7%BE%A4"><span class="toc-text">搭建集群</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Stay Hungry，Stay Foolish </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        非关系型数据库redis
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2024-05-19 20:45:57</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#redis" title="redis">redis</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content no-indent">
        <p><img src="/2024/05/19/Python/%E8%AF%BE%E7%A8%8B/12_%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93redis/index/1559132252584.png" alt="1559132252584.png"></p>
<h3 id="Nosql"><a href="#Nosql" class="headerlink" title="Nosql"></a>Nosql</h3><ul>
<li>not only sql   非关系型数据库</li>
<li>不支持SQL语法,没有通用的语言,每种nosql数据库都有自己的api和语法</li>
<li>使用键值对的形式存储数据</li>
</ul>
<h4 id="NoSQL-与-SQL数据库的比较"><a href="#NoSQL-与-SQL数据库的比较" class="headerlink" title="NoSQL 与 SQL数据库的比较"></a>NoSQL 与 SQL数据库的比较</h4><ul>
<li>适用场景不同:SQL数据库适用于关系特别复杂的数据查询场景,nosql反之</li>
<li>SQL支持事务,nosql基本不支持事务</li>
<li>两者在补短取长,呈现融合趋势</li>
</ul>
<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p>特征:</p>
<ul>
<li>Redis本质上是Key-Value类型的内存数据库</li>
<li>支持数据持久化</li>
<li>提供五种数据结构的存储</li>
<li>支持数据的备份, master-slave模式</li>
<li>Redis数据库容量受物理内存的限制,不能用作海量数据的高性能读写</li>
</ul>
<p>优势:</p>
<ul>
<li>性能极高</li>
<li>丰富的数据类型</li>
<li>原子性 操作原子性</li>
<li>丰富的特征</li>
</ul>
<p>安装 与 配置自行查看课件</p>
<p>服务端 : Redis-server</p>
<p>ps -aux | grep redis  查看Redis服务器进程</p>
<p>sudo kill -9 pid(进程号)  杀死Redis服务器</p>
<p>sudo Redis-server &#x2F;etc&#x2F;redis&#x2F;redis.conf  加载指定的配置文件</p>
<p>客户端 : Redis-cli</p>
<p>运行测试 : ping</p>
<p>redis被配置为保存数据库快照时,不能持久化到硬盘,用来修改数据的命令不能使用.  解决方法:强制关闭redis快照,运行config set stop-writes-on-bgsave-error no,关闭该选项</p>
<h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><ul>
<li>redis是key-value的数据结构，每条数据都是⼀个键值对</li>
<li>键的类型是字符串</li>
<li>注意：键不能重复</li>
<li>值的类型有五种<ul>
<li>字符串</li>
<li>哈希 hash</li>
<li>列表</li>
<li>集合</li>
<li>有序集合</li>
</ul>
</li>
</ul>
<h4 id="Redis操作"><a href="#Redis操作" class="headerlink" title="Redis操作"></a>Redis操作</h4><p>在Ubuntu下面操作:<br>redis的操作是以key - value的形式存储的<br>key为字符串<br>Value: 字符串,hash表,list集合,set集合,zset集合 五种类型</p>
<p>查找键支持正则表达式</p>
<p>共有16张表</p>
<p>换表:  select  表的序号</p>
<p><strong>指定过期时间 : expire key seconds</strong></p>
<p>保存键值对并设置有效期: setex key second value <strong>注意参数顺序</strong></p>
<p>redis 中以<strong>二进制</strong>存储,取用数据时 需转换</p>
<p><strong>字符串类型</strong>:</p>
<p>添加&#x2F;修改:</p>
<ol>
<li>基本键值对: set key value</li>
<li>保存键值对并设置有效期: setex key second value</li>
<li>设置多个键值对: mset key1 value1 key2 value2 ..</li>
<li>追加值: append key value</li>
</ol>
<p>获取值:</p>
<p>​	1.获取基本值: get key</p>
<p>​	2.获取多个值: mget key1 key2 ..</p>
<p>查看键:<br>    1.查看所有的键: keys *<br>    2.查看以a开头的键: keys a*<br>    3.看键是否存在: exists key   存在返回1,不存在返回0<br>    4.查看键对应的值的类型: type key1</p>
<p>删除键值对:<br>    1.删除键: del key1 key2 ..<br>    2.设置键有效期,删除键:expire key seconds<br>    3.查看键的有效期: ttl key</p>
<p>​		永久的键值 ttl key –&gt;  -1</p>
<p>​		过期的键值 ttl key –&gt;  -2</p>
<p><strong>hash类型</strong></p>
<p>field :属性名       value : 属性值</p>
<p>增加数据</p>
<ol>
<li>增加域的key和值: hset key field value</li>
<li>设置域的多个属性: hmset key filed1 value1 field2 value2…</li>
<li>修改属性 : hset user name itheima </li>
<li>为域中指定字段的整数值加上增量:hincrby key field increment</li>
<li>为域中指定字段的浮点数值加上增量:hincrbyfloat key field increment</li>
</ol>
<p>获取数据:     获得的数据均为  <strong>二进制</strong></p>
<ol>
<li>获取域的属性(字段)的值: hget key field</li>
<li>获取域的多个指定属性的值: hmget key filed1 field2..    列表类型</li>
<li>获取域的所有属性(字段): hkeys key                列表类型</li>
<li>获取域的所有属性的值:hvals key                 列表类型</li>
<li>获取域的所有属性和值: hgetall key            结果为字典类型</li>
<li>查看域中指定字段是否存在: hexists key field</li>
<li>获取域中字段数量: hlen key</li>
</ol>
<p>删除数据:<br>    1.删除多个属性(字段): hdel key field1 field2…</p>
<p><strong>list类型</strong>:<br>插入数据:<br>    1.左侧插入数据: lpush key value1 value2 …<br>    2.右侧插入数据: rpush key value1 value2 …<br>    3.指定key,旧元素位置前插入元素: </p>
<ul>
<li><p>指定值前插入  不是指定索引插入</p>
<p>  格式：linsert  key  before  oldvalue  newvalue</p>
</li>
</ul>
<p>​	4.指定key,旧元素位置后插入元素: </p>
<p>​		格式：linsert key after oldvalue  newvalue</p>
<p>获取数据:<br>    1.获取从编号start位置到编号stop位置的元素:<br>    格式：lrange key start stop<br>    (注意点,最后一个元素可以使用-1表示)<br>    2.设置指定索引位置的元素值: lset key index value</p>
<ul>
<li>list 里set用法与其他类型不同</li>
</ul>
<p>删除数据:<br>     1.将key域列表中,前count次,值为value的元素删除:<br>        格式：　lrem key count value<br>        count:需要删除的个数<br>        value: 需要删除的值<br>        count&gt;0:从头开始数, count&lt;0从尾到头,count&#x3D;0查找所有元素</p>
<p><strong>set类型</strong><br>特点:无序(顺序)集合, 大小关系有序输出，不能存储重复元素</p>
<p>​	无序性 唯一性</p>
<ul>
<li><p>对于集合没有修改操作</p>
</li>
<li><p>全部具有大小关系,则查询时按大小关系有序输出0-9,a-z</p>
<p>  否则无序 但输出顺序固定</p>
</li>
</ul>
<p>添加元素   可以向已有值中添加数据</p>
<p>​	1.向key域(集合)中添加数据, sadd key member1 member2…)</p>
<p>获取元素:<br>    2.获取key域集合的所有元素: smembers key</p>
<p>删除元素:<br>    1.删除指定key元素的值: srem key value</p>
<p><img src="/2024/05/19/Python/%E8%AF%BE%E7%A8%8B/12_%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93redis/index/549850-20180703071915855-320179407.png" alt="img"></p>
<p><strong>Zset类型</strong><br>特点: 有序集合, score为权重值<br>序:自然顺序</p>
<p>没有修改操作</p>
<p>增加数据<br>    1.向key域集合中添加多个score1,member1数据<br>    格式: zadd key score1 member1 score2 memever2…</p>
<p>获取数据:<br>    1.返回指定范围内的member元素:<br>    格式:zrange key start stop<br>    start:为开始索引,包含<br>    stop:为结尾索引,包含, -1表示最后一个元素</p>
<pre><code>2.获取min和max权值之间(包含)的成员值: 
格式:zrangebyscore key min max

zrange 递增输出  zrevrange 递减输出
zrange/zrevrange key min max
</code></pre>
<p>​	3.获取key域集合中member的score的权重值:<br>​	格式:zscore key member</p>
<p>删除元素:<br>    1.删除域集合中指定的元素值:<br>    格式:zrem key score member…   删除后值的权重不变</p>
<p>​	zrem key member1 member2… 删除值的权重之后的权重不变, 将删	除值的权重之前的权重的值剪切到最后,重新赋予权重,权重顺序递增<br>​	2.删除集合中权重在指定范围内(min,max)的元素:<br>​	格式:zremrangebyscore key min max</p>
<h3 id="redis管道的使用"><a href="#redis管道的使用" class="headerlink" title="redis管道的使用"></a>redis管道的使用</h3><ul>
<li>设置指令 删除指令        可以使用 管道</li>
<li>获取指令                         不能使用  管道,因为获取指令需要立即执行</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pl = redis_conn.pipeline()</span><br><span class="line">sku_data = pl.hgetall(<span class="string">&#x27;carts_%s&#x27;</span>%user.<span class="built_in">id</span>)  </span><br><span class="line"><span class="comment"># sku_data 数据类型 &lt;class &#x27;redis.client.Pipeline&#x27;&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="与python交互"><a href="#与python交互" class="headerlink" title="与python交互"></a>与python交互</h3><ul>
<li>from redis import StrictRedis</li>
<li>sr &#x3D; StrictRedis(host&#x3D;’localhost’, port&#x3D;6379, db&#x3D;0)</li>
<li>简写 : sr&#x3D;StrictRedis()</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#创建StrictRedis对象，与redis服务器建⽴连接</span></span><br><span class="line">        sr=StrictRedis()</span><br><span class="line">        <span class="comment">#添加键name，值为itheima</span></span><br><span class="line">        result=sr.<span class="built_in">set</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;itheima&#x27;</span>)</span><br><span class="line">        <span class="comment">#输出响应结果，如果添加成功则返回True，否则返回False</span></span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure>

<ul>
<li><pre><code class="python">  src=StrictRedisCluster(startup_nodes=startup_nodes,decode_responses=True)
</code></pre>
</li>
</ul>
<h3 id="搭建主从"><a href="#搭建主从" class="headerlink" title="搭建主从"></a>搭建主从</h3><ul>
<li><p>通过主从配置实现读写分离</p>
</li>
<li><p>一个主master 可以拥有多个从 slave ,⼀个slave⼜可以拥有多个slave</p>
</li>
<li><p>master可写可读   slave只能读</p>
</li>
<li><p>作用: </p>
<ul>
<li>分流,提升服务器的响应能力</li>
<li>主从分离,从物理上防止数据损坏</li>
</ul>
</li>
<li><p>主从配置   查看课件</p>
<p>  bind</p>
<p>  port</p>
<p>  slaveof</p>
<p>  开启服务器:主服务器sudo redis-server &#x2F;etc&#x2F;redis&#x2F;redis.conf</p>
<p>  ​			从服务器sudo redis-server &#x2F;etc&#x2F;redis&#x2F;slave.conf</p>
<p>  登录 :主 redis-cli -h 192.168.92.129 -p 6379</p>
<p>  ​	  从 redis-cli -h 192.168.92.129 -p 6378</p>
</li>
</ul>
<h3 id="搭建集群"><a href="#搭建集群" class="headerlink" title="搭建集群"></a>搭建集群</h3><ul>
<li>作用: 提高服务器响应的能力</li>
<li>把多个主从集合在一起,必须三组及以上 即最少六台服务器</li>
<li>如果集群中有超过一半损坏 那么集群就关闭了</li>
<li>分类:<ul>
<li>软件层面   一台电脑开多个服务器</li>
<li>硬件层面</li>
</ul>
</li>
</ul>
<p>集群搭建:  参考课件 <a href="..%5C%E8%AF%BE%E7%A8%8B%5C16day%5Credis_note_v1.0%5Credis.html">redis.html</a> </p>
<ul>
<li><p>redis集群搭建 <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wuxl360/p/5920330.html">http://www.cnblogs.com/wuxl360/p/5920330.html</a></p>
</li>
<li><p>[Python]搭建redis集群 <a target="_blank" rel="noopener" href="http://blog.5ibc.net/p/51020.html">http://blog.5ibc.net/p/51020.html</a></p>
</li>
<li><p>配置文件 最少六个</p>
</li>
<li><p>创建集群命令  Ruby环境</p>
</li>
<li><p>数据写入地址 根据CRC16算法</p>
</li>
</ul>

        
            <div class="donate-container">
    <div class="donate-button">
        <button id="donate-button">donate</button>
    </div>
    <div class="donate-img-container hide" id="donate-img-container">
        <img id="donate-img" src="" data-src="/img/donate.jpg">
        <p> 感谢您给予的支持 </p>
    </div>
</div>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/忘機">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank" href="http://weibo.com/3919408003">
                            <span class="fa-stack fa-lg">
                                  <i class="iconfont icon-weibo"></i>
                            </span>
            </a>
        </li>
        

        

        
        <li>
            <a target="_blank"  href="https://github.com/MyGodOnLoad">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="../../../../../../js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






</html>
